# MNDT-2024-0001
## Description
IBM's Db2 for Windows contains a local privilege escalation vulnerability which affected versions 11.1.1010.160 and prior.

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges 

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce. An attacker would need a user interface to exploit the vulnerability.

## CVE Reference
CVE-2023-47145

## Common Weakness Enumeration
CWE-648: Incorrect Use of Privileged APIs

## Common Vulnerability Scoring System
Base Score: 8.4 - Vector: AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

## Technical Details

The installation of the software uses the Windows Installer framework and an MSI file is cached in C:\Windows\Installer. An unprivileged user can trigger a repair operation, either by using the Windows Installer API or by running `msiexec.exe /fa c:\Windows\Installer\[XXXXX].msi`.

Running a repair operation will trigger a number of file operations in a folder writeable by low-privileged users. More specifically, if a low-privileged user places a file in the folder and the file is not created during the repair operation, the MSI repair functionality will execute the file with SYSTEM privileges. Since there are no integrity checks for the file executed, an attacker could place an arbitrary file and elevate their privileges.


## Resolution
The vulnerability has been remediated through special builds for versions 10.5, 11.1, and 11.5 and are available from IBM.

## Discovery Credits
- James Curbow, Mandiant

## Disclosure Timeline
- 18-Oct-2023 - Vulnerability reported to IBM
- 07-Jan-2024 - Vulnerability confirmed by IBM
- 07-Jan-2024 - Vulnerability fixed in special builds for versions 10.5, 11.1, and 11.5
 
## References
- [Escalating Privileges via Third-Party Windows Installers](https://www.mandiant.com/resources/blog/privileges-third-party-windows-installers)
- [Mitre CVE-2023-26078](https://www.cve.org/CVERecord?id=CVE-2023-26078)
- [IBM Security Advisory](https://www.ibm.com/support/pages/node/7105500)
