# MNDT-2024-0002

## Description
Objectplanet Opinio version 7.22 and prior uses a cryptographically weak pseudo-random number generator (PRNG) coupled to a predictable seed, which could lead to an unauthenticated account takeover of any user on the application.

## CVE Reference
CVE-2023-4472

## CWE
CWE-335 Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)

## Impact
High - An unauthenticated attacker could abuse this to change any Opinio user’s password to an arbitrary one if the targeted user has an e-mail configured.

## Exploitability
Medium - A review of the application's source code is required in order to identify the predictable seed and vulnerable function. As such, automated scanners cannot identify this issue.

## Technical Details
Objectplanet Opinio provided a predictable seed as parameter to a weak PRNG when generating password reset tokens. After sending a password reset request for the targeted user, it was possible to brute-force and guess the seed in a reasonable amount of requests. The retrieved token could then be used to reset the victim's password.

## Resolution
Objectplanet released a fix in the version 7.23 of Opinio. Instead of using a weak PRNG with a predictable seed, Object Planet now uses the SecureRandom random number generator class and provides no seed to the constructor.

## Discovery Credits
Amine Ismail, Mandiant

## Disclosure Timeline
- 2023-08-21 - Issue reported to Object Planet and CVE number assigned.
- 2023-08-22 - Issue confirmed by Object Planet and announced that a patch will be released in the next version.
- 2023-08-31 - Object Planet released version 7.23.  Mandiant delayed vulnerability disclosure to allow Opinio customers time to patch.

## References 
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4472
- https://www.objectplanet.com/opinio/changelog.html
