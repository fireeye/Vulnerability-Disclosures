# MNDT-2023-0018
The application OktaAgentService.exe was identified as performing HTTP requests to the Okta API to sync information between Okta and Active Directory. The encrypted AgentToken in `OktaAgentService.exe.config` file can be decrypted and reused to replay request to the Okta API which returned cleartext password of user authenticating on Okta.

## Common Weakness Enumeration
CWE-312: Cleartext Storage of Sensitive Information

## Impact
Very High: An attacker could send requests to the Okta API and gather any usersâ€™ credentials that are going through the authentication process. 

## Exploitability
Low: An attacker would require having administrator privilege on the system that the Okta Agent Service is installed. 

## CVE Reference
No CVE assigned

## Technical Details
While conducting independent security research, Mandiant was able to retrieve cleartext passwords of any users that authenticated through the Okta authentication process. To achieve this, Mandiant performed static analysis of the OktaAgentService.exe and eventually found the decryption method of the AgentToken used by the application to authenticate on the Okta API. By retrieving the decrypted API token, Mandiant could essentially impersonate the service and send request before the OktaAgentService which would result receiving response from the server which contain cleartext password.

## Discovery Credits
- David Lebrun, Mandiant

## Disclosure Timeline
- 2023-07-26 - Issue reported to the vendor.
- 2023-08-29 - Meeting with the vendor to provide additional information.
- 2023-09-07 - Official reply from Okta that they will most likely not assign this as a vulnerability.
- 2023-09-18 - TrustedSec released a blog post about this attack.
- 2023-11-27 - 90 days disclosure policy release.

## References
- [TrustedSec Okta for Red Teamers](https://www.trustedsec.com/blog/okta-for-red-teamers/)
